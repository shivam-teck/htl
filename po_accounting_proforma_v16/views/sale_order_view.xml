<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="sale_order_form_inherited" model="ir.ui.view">
            <field name="name">sale.order.form.inherited</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//form//header//button[@id='action_confirm']" position="after">
                    <button name="payment_create" string="Create Payments" type="object"/>
                </xpath>
                <xpath expr="//form//header//button[@id='action_confirm'][1]" position="attributes">
                    <attribute name="invisible">hide_confirm_button == False</attribute>
                </xpath>
                <xpath expr="//form//header//button[@name='action_confirm'][2]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//form//header//button[@id='create_invoice']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//form/sheet/notebook/page[@name='order_lines']/group[@name='note_group']/group[2]"
                       position="after">
                    <group class="oe_subtotal_footer oe_right" colspan="2">
                        <field name="balance_amount" style="white-space: nowrap; font-weight: bold; font-size: 1.3em;"
                               force_save="1"/>
                        <field name="total_additional_discount" style="white-space: nowrap; font-weight: bold; font-size: 1.3em;"
                               force_save="1"/>
                        <field name="hide_confirm_button" invisible="1"/>

                    </group>
                </xpath>
                <xpath expr="//group[@name='partner_details']" position="inside">
                    <field name="create_invoice" invisible="1"/>
                </xpath>
                <xpath expr="//form//header//button[@id='create_invoice']" position="attributes">
                    <attribute name="invisible">create_invoice == False</attribute>
                </xpath>
                <xpath expr="//form//header//button[@id='create_invoice_percentage']" position="attributes">
                    <attribute name="invisible">create_invoice == False</attribute>
                </xpath>
                <xpath expr="//page[@name='customer_signature']" position="before">
                    <page name="payment_by_terms" string="Customer Payments">
                        <!--                        removed attrs on payment terms-->
                        <field name="payments_by_terms" readonly="state == 'sale'">
                            <list create="false">
                            </list>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>
        <record id="action_compute_confirm_so" model="ir.actions.server">
            <field name="name">Confirm So</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="binding_model_id" ref="sale.model_sale_order"/>
            <field name="binding_view_types">list</field>
            <field name="state">code</field>
            <field name="code">action = records.compute_balance_amount()</field>
        </record>
        <record id="action_compute_invoice" model="ir.actions.server">
                    <field name="name">Create Invoice</field>
                    <field name="model_id" ref="sale.model_sale_order"/>
                    <field name="binding_model_id" ref="sale.model_sale_order"/>
                    <field name="binding_view_types">list</field>
                    <field name="state">code</field>
                    <field name="code">action = records.compute_create_invoice()</field>
                </record>


    </data>
</odoo>
